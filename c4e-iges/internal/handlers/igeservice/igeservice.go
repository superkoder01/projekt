/*
BMSFES. 
Copyright (C) 2022-2035 

This file is part of the BMSFES solution. 
BMSFES is free software: you can redistribute it and/or modify 
it under the terms of the GNU Affero General Public License as 
published by the Free Software Foundation, either version 3 of the 
License, or (at your option) any later version.
 
BMSFES solution is distributed in the hope that it will be useful, 
but WITHOUT ANY WARRANTY; without even the implied warranty of 
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License 
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
package igeservice

import (
	"context"
	"gitlab.sce-ovoo.pl/ovoo/products/chain4energy/billing/c4e-iges.git/internal/config"
	"gitlab.sce-ovoo.pl/ovoo/products/chain4energy/billing/c4e-iges.git/internal/factory"
	"gitlab.sce-ovoo.pl/ovoo/products/chain4energy/billing/c4e-iges.git/internal/handlers/igeservice/eventhandler"
	"gitlab.sce-ovoo.pl/ovoo/products/chain4energy/billing/c4e-iges.git/internal/logger"
	"gitlab.sce-ovoo.pl/ovoo/products/chain4energy/billing/c4e-iges.git/internal/services/subscriber"
	"strconv"
)

type Service interface {
	Start(dryRun bool) error
	Shutdown()
}

type igeService struct {
	context.Context
	faktory      factory.Factory
	log          logger.Logger
	cfg          *config.AppConfig
	shutdownFunc func() error
	started      bool
}

func New(ctx context.Context, faktory factory.Factory, log logger.Logger, cfg *config.AppConfig) Service {
	return &igeService{ctx, faktory, log, cfg, nil, false}
}

func (service *igeService) Start(dryRun bool) error {
	if service.started {
		service.log.Warnf("%s-%s already started", service.cfg.ServiceName, service.cfg.ServiceVersion)
		return nil
	}

	handler := eventhandler.NewEventHandler(service.faktory, service.log, service.cfg)
	if err := handler.Initialize(); err != nil {
		service.log.Errorf("failed to initialize invoice event consumer: %v", err)
		return err
	}

	subscriberFactory := subscriber.NewInvoiceEventSubscriberFactory(context.Background(), subscriber.SubscriberType(service.cfg.Ports.InvoiceEventSubscriberPort), service.log, service.cfg)
	subskriber := subscriberFactory.MakeSubscriber(handler)
	service.shutdownFunc = subskriber.Close
	chanErr := subskriber.Subscribe(service)

	service.log.Infof("%s-%s started", service.cfg.ServiceName, service.cfg.ServiceVersion)

	if dryRun {
		for i := 1; i <= 1; i++ {
			message := []byte("{\n\t\"contract\": \"/1/12/07/2022\",\n\t\"startDate\": \"01/06/2022\",\n\t\"endDate\": \"30/06/2022\",\n\t\"serviceAccessPoints\": {\n\t\t\"PL_ZEWD_1405012128_06\": {\n\t\t\t\"excise\": 0.5,\n\t\t\t\"sale\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 0,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.405,\n\t\t\t\t\t\"net\": 40.5,\n\t\t\t\t\t\"gross\": 42.53,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 2.03,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 1,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 20,\n\t\t\t\t\t\"net\": 20,\n\t\t\t\t\t\"gross\": 24.6,\n\t\t\t\t\t\"vatRate\": 23,\n\t\t\t\t\t\"vat\": 4.6,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"distribution\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 4,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.75,\n\t\t\t\t\t\"net\": 0.75,\n\t\t\t\t\t\"gross\": 0.79,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.04,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 3,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 6.56,\n\t\t\t\t\t\"net\": 6.56,\n\t\t\t\t\t\"gross\": 6.89,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.33,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 7,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.33,\n\t\t\t\t\t\"net\": 0.33,\n\t\t\t\t\t\"gross\": 0.35,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 8,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0095,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 1,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.05,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 2,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.2223,\n\t\t\t\t\t\"net\": 22.23,\n\t\t\t\t\t\"gross\": 23.34,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 1.11,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 5,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0009,\n\t\t\t\t\t\"net\": 0.09,\n\t\t\t\t\t\"gross\": 0.09,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 6,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0047,\n\t\t\t\t\t\"net\": 0.47,\n\t\t\t\t\t\"gross\": 0.49,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 9,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 13.25,\n\t\t\t\t\t\"net\": 13.25,\n\t\t\t\t\t\"gross\": 13.91,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.66,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"repurchase\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 10,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"net\": 30.35,\n\t\t\t\t\t\"gross\": 30.35,\n\t\t\t\t\t\"excess\": 90\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"deposit\": {\n\t\t\t\t\"records\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 70, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 10.20, \"deposit\": 45, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 30, \"outcome\": 30, \"deposit\": 45, \"usedValue\": 30, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 42.53, \"outcome\": 30.35, \"deposit\": 15.20, \"usedValue\": 15.20, \"residualValue\": 30.35},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 90, \"deposit\": 45, \"usedValue\": 45, \"residualValue\": 90}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"repurchaseDetails\": [\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"0-1\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.651,\n\t\t\t\t\t\"net\": 1.3,\n\t\t\t\t\t\"gross\": 1.3\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"1-2\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5803,\n\t\t\t\t\t\"net\": 1.16,\n\t\t\t\t\t\"gross\": 1.16\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"2-3\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.55402,\n\t\t\t\t\t\"net\": 1.11,\n\t\t\t\t\t\"gross\": 1.11\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"3-4\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5425,\n\t\t\t\t\t\"net\": 1.09,\n\t\t\t\t\t\"gross\": 1.09\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"4-5\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.532,\n\t\t\t\t\t\"net\": 1.06,\n\t\t\t\t\t\"gross\": 1.06\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"5-6\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5383,\n\t\t\t\t\t\"net\": 1.08,\n\t\t\t\t\t\"gross\": 1.08\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"6-7\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.623,\n\t\t\t\t\t\"net\": 1.25,\n\t\t\t\t\t\"gross\": 1.25\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"7-8\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 1.19,\n\t\t\t\t\t\"gross\": 1.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"8-9\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.5712,\n\t\t\t\t\t\"net\": 2.28,\n\t\t\t\t\t\"gross\": 2.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"9-10\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.441,\n\t\t\t\t\t\"net\": 2.21,\n\t\t\t\t\t\"gross\": 2.21\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"10-11\",\n\t\t\t\t\t\"units\": 6,\n\t\t\t\t\t\"unitPrice\": 0.36464,\n\t\t\t\t\t\"net\": 2.19,\n\t\t\t\t\t\"gross\": 2.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"11-12\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.3395,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"12-13\",\n\t\t\t\t\t\"units\": 8,\n\t\t\t\t\t\"unitPrice\": 0.3612,\n\t\t\t\t\t\"net\": 2.89,\n\t\t\t\t\t\"gross\": 2.89\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"13-14\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"14-15\",\n\t\t\t\t\t\"units\": 3,\n\t\t\t\t\t\"unitPrice\": 0.315,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 0.95\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"15-16\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"16-17\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.38514,\n\t\t\t\t\t\"net\": 1.93,\n\t\t\t\t\t\"gross\": 1.93\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"17-18\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.4263,\n\t\t\t\t\t\"net\": 2.98,\n\t\t\t\t\t\"gross\": 2.98\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"18-19\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"19-20\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.728,\n\t\t\t\t\t\"net\": 1.46,\n\t\t\t\t\t\"gross\": 1.46\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"20-21\",\n\t\t\t\t\t\"units\": 1,\n\t\t\t\t\t\"unitPrice\": 0.78365,\n\t\t\t\t\t\"net\": 0.78,\n\t\t\t\t\t\"gross\": 0.78\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"21-22\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.735,\n\t\t\t\t\t\"net\": 1.47,\n\t\t\t\t\t\"gross\": 1.47\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"22-23\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.7343,\n\t\t\t\t\t\"net\": 2.94,\n\t\t\t\t\t\"gross\": 2.94\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"23-24\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.6308,\n\t\t\t\t\t\"net\": 3.15,\n\t\t\t\t\t\"gross\": 3.15\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t}\n}")
			//message := []byte("{\n\t\"contract\": \"aaa\",\n\t\"startDate\": \"01/06/2022\",\n\t\"endDate\": \"30/06/2022\",\n\t\"serviceAccessPoints\": {\n\t\t\"PL_ZEWD_1405012128_06\": {\n\t\t\t\"excise\": 0.5,\n\t\t\t\"sale\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 0,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.405,\n\t\t\t\t\t\"net\": 40.5,\n\t\t\t\t\t\"gross\": 42.53,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 2.03,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 1,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 20,\n\t\t\t\t\t\"net\": 20,\n\t\t\t\t\t\"gross\": 24.6,\n\t\t\t\t\t\"vatRate\": 23,\n\t\t\t\t\t\"vat\": 4.6,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"distribution\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 4,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.75,\n\t\t\t\t\t\"net\": 0.75,\n\t\t\t\t\t\"gross\": 0.79,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.04,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 3,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 6.56,\n\t\t\t\t\t\"net\": 6.56,\n\t\t\t\t\t\"gross\": 6.89,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.33,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 7,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.33,\n\t\t\t\t\t\"net\": 0.33,\n\t\t\t\t\t\"gross\": 0.35,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 8,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0095,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 1,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.05,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 2,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.2223,\n\t\t\t\t\t\"net\": 22.23,\n\t\t\t\t\t\"gross\": 23.34,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 1.11,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 5,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0009,\n\t\t\t\t\t\"net\": 0.09,\n\t\t\t\t\t\"gross\": 0.09,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 6,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0047,\n\t\t\t\t\t\"net\": 0.47,\n\t\t\t\t\t\"gross\": 0.49,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 9,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 13.25,\n\t\t\t\t\t\"net\": 13.25,\n\t\t\t\t\t\"gross\": 13.91,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.66,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"repurchase\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 10,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"net\": 30.35,\n\t\t\t\t\t\"gross\": 30.35,\n\t\t\t\t\t\"excess\": 90\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"deposit\": {\n\t\t\t\t\"records\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 70, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 10.20, \"deposit\": 45, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 30, \"outcome\": 30, \"deposit\": 45, \"usedValue\": 30, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 42.53, \"outcome\": 30.35, \"deposit\": 15.20, \"usedValue\": 15.20, \"residualValue\": 30.35},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 90, \"deposit\": 45, \"usedValue\": 45, \"residualValue\": 90}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"repurchaseDetails\": [\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"0-1\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.651,\n\t\t\t\t\t\"net\": 1.3,\n\t\t\t\t\t\"gross\": 1.3\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"1-2\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5803,\n\t\t\t\t\t\"net\": 1.16,\n\t\t\t\t\t\"gross\": 1.16\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"2-3\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.55402,\n\t\t\t\t\t\"net\": 1.11,\n\t\t\t\t\t\"gross\": 1.11\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"3-4\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5425,\n\t\t\t\t\t\"net\": 1.09,\n\t\t\t\t\t\"gross\": 1.09\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"4-5\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.532,\n\t\t\t\t\t\"net\": 1.06,\n\t\t\t\t\t\"gross\": 1.06\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"5-6\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5383,\n\t\t\t\t\t\"net\": 1.08,\n\t\t\t\t\t\"gross\": 1.08\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"6-7\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.623,\n\t\t\t\t\t\"net\": 1.25,\n\t\t\t\t\t\"gross\": 1.25\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"7-8\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 1.19,\n\t\t\t\t\t\"gross\": 1.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"8-9\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.5712,\n\t\t\t\t\t\"net\": 2.28,\n\t\t\t\t\t\"gross\": 2.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"9-10\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.441,\n\t\t\t\t\t\"net\": 2.21,\n\t\t\t\t\t\"gross\": 2.21\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"10-11\",\n\t\t\t\t\t\"units\": 6,\n\t\t\t\t\t\"unitPrice\": 0.36464,\n\t\t\t\t\t\"net\": 2.19,\n\t\t\t\t\t\"gross\": 2.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"11-12\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.3395,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"12-13\",\n\t\t\t\t\t\"units\": 8,\n\t\t\t\t\t\"unitPrice\": 0.3612,\n\t\t\t\t\t\"net\": 2.89,\n\t\t\t\t\t\"gross\": 2.89\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"13-14\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"14-15\",\n\t\t\t\t\t\"units\": 3,\n\t\t\t\t\t\"unitPrice\": 0.315,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 0.95\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"15-16\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"16-17\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.38514,\n\t\t\t\t\t\"net\": 1.93,\n\t\t\t\t\t\"gross\": 1.93\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"17-18\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.4263,\n\t\t\t\t\t\"net\": 2.98,\n\t\t\t\t\t\"gross\": 2.98\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"18-19\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"19-20\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.728,\n\t\t\t\t\t\"net\": 1.46,\n\t\t\t\t\t\"gross\": 1.46\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"20-21\",\n\t\t\t\t\t\"units\": 1,\n\t\t\t\t\t\"unitPrice\": 0.78365,\n\t\t\t\t\t\"net\": 0.78,\n\t\t\t\t\t\"gross\": 0.78\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"21-22\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.735,\n\t\t\t\t\t\"net\": 1.47,\n\t\t\t\t\t\"gross\": 1.47\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"22-23\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.7343,\n\t\t\t\t\t\"net\": 2.94,\n\t\t\t\t\t\"gross\": 2.94\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"23-24\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.6308,\n\t\t\t\t\t\"net\": 3.15,\n\t\t\t\t\t\"gross\": 3.15\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t}\n}")
			//message := []byte("{\n\t\"contract\": \"/1/12/07/2022\",\n\t\"startDate\": \"\",\n\t\"endDate\": \"30/06/2022\",\n\t\"serviceAccessPoints\": {\n\t\t\"PL_ZEWD_1405012128_06\": {\n\t\t\t\"excise\": 0.5,\n\t\t\t\"sale\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 0,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.405,\n\t\t\t\t\t\"net\": 40.5,\n\t\t\t\t\t\"gross\": 42.53,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 2.03,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 1,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 20,\n\t\t\t\t\t\"net\": 20,\n\t\t\t\t\t\"gross\": 24.6,\n\t\t\t\t\t\"vatRate\": 23,\n\t\t\t\t\t\"vat\": 4.6,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"distribution\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 4,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.75,\n\t\t\t\t\t\"net\": 0.75,\n\t\t\t\t\t\"gross\": 0.79,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.04,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 3,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 6.56,\n\t\t\t\t\t\"net\": 6.56,\n\t\t\t\t\t\"gross\": 6.89,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.33,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 7,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.33,\n\t\t\t\t\t\"net\": 0.33,\n\t\t\t\t\t\"gross\": 0.35,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 8,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0095,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 1,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.05,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 2,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.2223,\n\t\t\t\t\t\"net\": 22.23,\n\t\t\t\t\t\"gross\": 23.34,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 1.11,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 5,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0009,\n\t\t\t\t\t\"net\": 0.09,\n\t\t\t\t\t\"gross\": 0.09,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 6,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0047,\n\t\t\t\t\t\"net\": 0.47,\n\t\t\t\t\t\"gross\": 0.49,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 9,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 13.25,\n\t\t\t\t\t\"net\": 13.25,\n\t\t\t\t\t\"gross\": 13.91,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.66,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"repurchase\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 10,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"net\": 30.35,\n\t\t\t\t\t\"gross\": 30.35,\n\t\t\t\t\t\"excess\": 90\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"deposit\": {\n\t\t\t\t\"records\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 70, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 10.20, \"deposit\": 45, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 30, \"outcome\": 30, \"deposit\": 45, \"usedValue\": 30, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 42.53, \"outcome\": 30.35, \"deposit\": 15.20, \"usedValue\": 15.20, \"residualValue\": 30.35},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 90, \"deposit\": 45, \"usedValue\": 45, \"residualValue\": 90}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"repurchaseDetails\": [\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"0-1\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.651,\n\t\t\t\t\t\"net\": 1.3,\n\t\t\t\t\t\"gross\": 1.3\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"1-2\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5803,\n\t\t\t\t\t\"net\": 1.16,\n\t\t\t\t\t\"gross\": 1.16\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"2-3\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.55402,\n\t\t\t\t\t\"net\": 1.11,\n\t\t\t\t\t\"gross\": 1.11\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"3-4\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5425,\n\t\t\t\t\t\"net\": 1.09,\n\t\t\t\t\t\"gross\": 1.09\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"4-5\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.532,\n\t\t\t\t\t\"net\": 1.06,\n\t\t\t\t\t\"gross\": 1.06\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"5-6\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5383,\n\t\t\t\t\t\"net\": 1.08,\n\t\t\t\t\t\"gross\": 1.08\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"6-7\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.623,\n\t\t\t\t\t\"net\": 1.25,\n\t\t\t\t\t\"gross\": 1.25\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"7-8\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 1.19,\n\t\t\t\t\t\"gross\": 1.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"8-9\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.5712,\n\t\t\t\t\t\"net\": 2.28,\n\t\t\t\t\t\"gross\": 2.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"9-10\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.441,\n\t\t\t\t\t\"net\": 2.21,\n\t\t\t\t\t\"gross\": 2.21\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"10-11\",\n\t\t\t\t\t\"units\": 6,\n\t\t\t\t\t\"unitPrice\": 0.36464,\n\t\t\t\t\t\"net\": 2.19,\n\t\t\t\t\t\"gross\": 2.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"11-12\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.3395,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"12-13\",\n\t\t\t\t\t\"units\": 8,\n\t\t\t\t\t\"unitPrice\": 0.3612,\n\t\t\t\t\t\"net\": 2.89,\n\t\t\t\t\t\"gross\": 2.89\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"13-14\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"14-15\",\n\t\t\t\t\t\"units\": 3,\n\t\t\t\t\t\"unitPrice\": 0.315,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 0.95\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"15-16\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"16-17\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.38514,\n\t\t\t\t\t\"net\": 1.93,\n\t\t\t\t\t\"gross\": 1.93\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"17-18\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.4263,\n\t\t\t\t\t\"net\": 2.98,\n\t\t\t\t\t\"gross\": 2.98\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"18-19\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"19-20\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.728,\n\t\t\t\t\t\"net\": 1.46,\n\t\t\t\t\t\"gross\": 1.46\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"20-21\",\n\t\t\t\t\t\"units\": 1,\n\t\t\t\t\t\"unitPrice\": 0.78365,\n\t\t\t\t\t\"net\": 0.78,\n\t\t\t\t\t\"gross\": 0.78\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"21-22\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.735,\n\t\t\t\t\t\"net\": 1.47,\n\t\t\t\t\t\"gross\": 1.47\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"22-23\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.7343,\n\t\t\t\t\t\"net\": 2.94,\n\t\t\t\t\t\"gross\": 2.94\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"23-24\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.6308,\n\t\t\t\t\t\"net\": 3.15,\n\t\t\t\t\t\"gross\": 3.15\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t}\n}")
			//message := []byte("{\n\t\"contract\": \"/1/12/07/2022\",\n\t\"startDate\": \"01/06/2022\",\n\t\"endDate\": \"\",\n\t\"serviceAccessPoints\": {\n\t\t\"PL_ZEWD_1405012128_06\": {\n\t\t\t\"excise\": 0.5,\n\t\t\t\"sale\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 0,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.405,\n\t\t\t\t\t\"net\": 40.5,\n\t\t\t\t\t\"gross\": 42.53,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 2.03,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 1,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 20,\n\t\t\t\t\t\"net\": 20,\n\t\t\t\t\t\"gross\": 24.6,\n\t\t\t\t\t\"vatRate\": 23,\n\t\t\t\t\t\"vat\": 4.6,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"distribution\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 4,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.75,\n\t\t\t\t\t\"net\": 0.75,\n\t\t\t\t\t\"gross\": 0.79,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.04,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 3,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 6.56,\n\t\t\t\t\t\"net\": 6.56,\n\t\t\t\t\t\"gross\": 6.89,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.33,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 7,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.33,\n\t\t\t\t\t\"net\": 0.33,\n\t\t\t\t\t\"gross\": 0.35,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 8,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0095,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 1,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.05,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 2,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.2223,\n\t\t\t\t\t\"net\": 22.23,\n\t\t\t\t\t\"gross\": 23.34,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 1.11,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 5,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0009,\n\t\t\t\t\t\"net\": 0.09,\n\t\t\t\t\t\"gross\": 0.09,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 6,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0047,\n\t\t\t\t\t\"net\": 0.47,\n\t\t\t\t\t\"gross\": 0.49,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 9,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 13.25,\n\t\t\t\t\t\"net\": 13.25,\n\t\t\t\t\t\"gross\": 13.91,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.66,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"repurchase\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 10,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"net\": 30.35,\n\t\t\t\t\t\"gross\": 30.35,\n\t\t\t\t\t\"excess\": 90\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"deposit\": {\n\t\t\t\t\"records\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 70, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 10.20, \"deposit\": 45, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 30, \"outcome\": 30, \"deposit\": 45, \"usedValue\": 30, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 42.53, \"outcome\": 30.35, \"deposit\": 15.20, \"usedValue\": 15.20, \"residualValue\": 30.35},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 90, \"deposit\": 45, \"usedValue\": 45, \"residualValue\": 90}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"repurchaseDetails\": [\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"0-1\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.651,\n\t\t\t\t\t\"net\": 1.3,\n\t\t\t\t\t\"gross\": 1.3\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"1-2\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5803,\n\t\t\t\t\t\"net\": 1.16,\n\t\t\t\t\t\"gross\": 1.16\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"2-3\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.55402,\n\t\t\t\t\t\"net\": 1.11,\n\t\t\t\t\t\"gross\": 1.11\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"3-4\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5425,\n\t\t\t\t\t\"net\": 1.09,\n\t\t\t\t\t\"gross\": 1.09\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"4-5\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.532,\n\t\t\t\t\t\"net\": 1.06,\n\t\t\t\t\t\"gross\": 1.06\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"5-6\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5383,\n\t\t\t\t\t\"net\": 1.08,\n\t\t\t\t\t\"gross\": 1.08\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"6-7\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.623,\n\t\t\t\t\t\"net\": 1.25,\n\t\t\t\t\t\"gross\": 1.25\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"7-8\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 1.19,\n\t\t\t\t\t\"gross\": 1.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"8-9\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.5712,\n\t\t\t\t\t\"net\": 2.28,\n\t\t\t\t\t\"gross\": 2.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"9-10\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.441,\n\t\t\t\t\t\"net\": 2.21,\n\t\t\t\t\t\"gross\": 2.21\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"10-11\",\n\t\t\t\t\t\"units\": 6,\n\t\t\t\t\t\"unitPrice\": 0.36464,\n\t\t\t\t\t\"net\": 2.19,\n\t\t\t\t\t\"gross\": 2.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"11-12\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.3395,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"12-13\",\n\t\t\t\t\t\"units\": 8,\n\t\t\t\t\t\"unitPrice\": 0.3612,\n\t\t\t\t\t\"net\": 2.89,\n\t\t\t\t\t\"gross\": 2.89\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"13-14\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"14-15\",\n\t\t\t\t\t\"units\": 3,\n\t\t\t\t\t\"unitPrice\": 0.315,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 0.95\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"15-16\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"16-17\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.38514,\n\t\t\t\t\t\"net\": 1.93,\n\t\t\t\t\t\"gross\": 1.93\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"17-18\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.4263,\n\t\t\t\t\t\"net\": 2.98,\n\t\t\t\t\t\"gross\": 2.98\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"18-19\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"19-20\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.728,\n\t\t\t\t\t\"net\": 1.46,\n\t\t\t\t\t\"gross\": 1.46\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"20-21\",\n\t\t\t\t\t\"units\": 1,\n\t\t\t\t\t\"unitPrice\": 0.78365,\n\t\t\t\t\t\"net\": 0.78,\n\t\t\t\t\t\"gross\": 0.78\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"21-22\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.735,\n\t\t\t\t\t\"net\": 1.47,\n\t\t\t\t\t\"gross\": 1.47\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"22-23\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.7343,\n\t\t\t\t\t\"net\": 2.94,\n\t\t\t\t\t\"gross\": 2.94\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"23-24\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.6308,\n\t\t\t\t\t\"net\": 3.15,\n\t\t\t\t\t\"gross\": 3.15\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t}\n}")
			//message := []byte("{\n\t\"contract\": \"/1/12/07/2022\",\n\t\"startDate\": \"01/06/2022\",\n\t\"endDate\": \"30/06/2022\"}")
			//message := []byte("{\n\t\"contract\": \"/1/12/07/2022\",\n\t\"startDate\": \"01/06/2022\",\n\t\"endDate\": \"30/06/2022\",\n\t\"serviceAccessPoints\": {\n\t\t\"PL_ZEWD_1405012128_99\": {\n\t\t\t\"excise\": 0.5,\n\t\t\t\"sale\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 0,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.405,\n\t\t\t\t\t\"net\": 40.5,\n\t\t\t\t\t\"gross\": 42.53,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 2.03,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 1,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 20,\n\t\t\t\t\t\"net\": 20,\n\t\t\t\t\t\"gross\": 24.6,\n\t\t\t\t\t\"vatRate\": 23,\n\t\t\t\t\t\"vat\": 4.6,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"distribution\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 4,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.75,\n\t\t\t\t\t\"net\": 0.75,\n\t\t\t\t\t\"gross\": 0.79,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.04,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 3,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 6.56,\n\t\t\t\t\t\"net\": 6.56,\n\t\t\t\t\t\"gross\": 6.89,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.33,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 7,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.33,\n\t\t\t\t\t\"net\": 0.33,\n\t\t\t\t\t\"gross\": 0.35,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 8,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0095,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 1,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.05,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 2,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.2223,\n\t\t\t\t\t\"net\": 22.23,\n\t\t\t\t\t\"gross\": 23.34,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 1.11,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 5,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0009,\n\t\t\t\t\t\"net\": 0.09,\n\t\t\t\t\t\"gross\": 0.09,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 6,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 0.0047,\n\t\t\t\t\t\"net\": 0.47,\n\t\t\t\t\t\"gross\": 0.49,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.02,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 2,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 9,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"unitPrice\": 13.25,\n\t\t\t\t\t\"net\": 13.25,\n\t\t\t\t\t\"gross\": 13.91,\n\t\t\t\t\t\"vatRate\": 5,\n\t\t\t\t\t\"vat\": 0.66,\n\t\t\t\t\t\"readType\": 0,\n\t\t\t\t\t\"factor\": {\n\t\t\t\t\t\t\"factorType\": 0,\n\t\t\t\t\t\t\"value\": 1\n\t\t\t\t\t},\n\t\t\t\t\t\"consumed\": 0\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"repurchase\": [\n\t\t\t\t{\n\t\t\t\t\t\"itemCode\": 10,\n\t\t\t\t\t\"meterNumber\": \"72421727\",\n\t\t\t\t\t\"from\": \"01/06/2022\",\n\t\t\t\t\t\"to\": \"30/06/2022\",\n\t\t\t\t\t\"net\": 30.35,\n\t\t\t\t\t\"gross\": 30.35,\n\t\t\t\t\t\"excess\": 90\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"deposit\": {\n\t\t\t\t\"records\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 200, \"outcome\": 10, \"deposit\": 0, \"usedValue\": 0, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 70, \"outcome\": 50, \"deposit\": 10, \"usedValue\": 10, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 40, \"deposit\": 50, \"usedValue\": 50, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 90, \"outcome\": 45, \"deposit\": 40, \"usedValue\": 40, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 40, \"outcome\": 10.20, \"deposit\": 45, \"usedValue\": 40, \"residualValue\": 0},\n\t\t\t\t\t\t\"amount\": {\"income\": 30, \"outcome\": 30, \"deposit\": 45, \"usedValue\": 30, \"residualValue\": 0}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"value\": {\"income\": 42.53, \"outcome\": 30.35, \"deposit\": 15.20, \"usedValue\": 15.20, \"residualValue\": 30.35},\n\t\t\t\t\t\t\"amount\": {\"income\": 100, \"outcome\": 90, \"deposit\": 45, \"usedValue\": 45, \"residualValue\": 90}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"repurchaseDetails\": [\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"0-1\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.651,\n\t\t\t\t\t\"net\": 1.3,\n\t\t\t\t\t\"gross\": 1.3\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"1-2\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5803,\n\t\t\t\t\t\"net\": 1.16,\n\t\t\t\t\t\"gross\": 1.16\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"2-3\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.55402,\n\t\t\t\t\t\"net\": 1.11,\n\t\t\t\t\t\"gross\": 1.11\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"3-4\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5425,\n\t\t\t\t\t\"net\": 1.09,\n\t\t\t\t\t\"gross\": 1.09\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"4-5\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.532,\n\t\t\t\t\t\"net\": 1.06,\n\t\t\t\t\t\"gross\": 1.06\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"5-6\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.5383,\n\t\t\t\t\t\"net\": 1.08,\n\t\t\t\t\t\"gross\": 1.08\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"6-7\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.623,\n\t\t\t\t\t\"net\": 1.25,\n\t\t\t\t\t\"gross\": 1.25\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"7-8\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 1.19,\n\t\t\t\t\t\"gross\": 1.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"8-9\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.5712,\n\t\t\t\t\t\"net\": 2.28,\n\t\t\t\t\t\"gross\": 2.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"9-10\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.441,\n\t\t\t\t\t\"net\": 2.21,\n\t\t\t\t\t\"gross\": 2.21\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"10-11\",\n\t\t\t\t\t\"units\": 6,\n\t\t\t\t\t\"unitPrice\": 0.36464,\n\t\t\t\t\t\"net\": 2.19,\n\t\t\t\t\t\"gross\": 2.19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"11-12\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.3395,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"12-13\",\n\t\t\t\t\t\"units\": 8,\n\t\t\t\t\t\"unitPrice\": 0.3612,\n\t\t\t\t\t\"net\": 2.89,\n\t\t\t\t\t\"gross\": 2.89\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"13-14\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"14-15\",\n\t\t\t\t\t\"units\": 3,\n\t\t\t\t\t\"unitPrice\": 0.315,\n\t\t\t\t\t\"net\": 0.95,\n\t\t\t\t\t\"gross\": 0.95\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"15-16\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.31996,\n\t\t\t\t\t\"net\": 1.28,\n\t\t\t\t\t\"gross\": 1.28\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"16-17\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.38514,\n\t\t\t\t\t\"net\": 1.93,\n\t\t\t\t\t\"gross\": 1.93\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"17-18\",\n\t\t\t\t\t\"units\": 7,\n\t\t\t\t\t\"unitPrice\": 0.4263,\n\t\t\t\t\t\"net\": 2.98,\n\t\t\t\t\t\"gross\": 2.98\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"18-19\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.595,\n\t\t\t\t\t\"net\": 2.38,\n\t\t\t\t\t\"gross\": 2.38\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"19-20\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.728,\n\t\t\t\t\t\"net\": 1.46,\n\t\t\t\t\t\"gross\": 1.46\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"20-21\",\n\t\t\t\t\t\"units\": 1,\n\t\t\t\t\t\"unitPrice\": 0.78365,\n\t\t\t\t\t\"net\": 0.78,\n\t\t\t\t\t\"gross\": 0.78\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"21-22\",\n\t\t\t\t\t\"units\": 2,\n\t\t\t\t\t\"unitPrice\": 0.735,\n\t\t\t\t\t\"net\": 1.47,\n\t\t\t\t\t\"gross\": 1.47\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"22-23\",\n\t\t\t\t\t\"units\": 4,\n\t\t\t\t\t\"unitPrice\": 0.7343,\n\t\t\t\t\t\"net\": 2.94,\n\t\t\t\t\t\"gross\": 2.94\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"date\": \"01/06/2022\",\n\t\t\t\t\t\"hourPeriod\": \"23-24\",\n\t\t\t\t\t\"units\": 5,\n\t\t\t\t\t\"unitPrice\": 0.6308,\n\t\t\t\t\t\"net\": 3.15,\n\t\t\t\t\t\"gross\": 3.15\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t}\n}")
			_ = handler.Execute(message, strconv.Itoa(i), "consumerName-"+strconv.Itoa(i))
		}
	}

	service.started = true
	service.log.Errorf("received from invoice event subscriber: %v", <-chanErr)

	if service.started {
		service.shutdownFunc()
	}
	service.log.Infof("%s-%s stopped", service.cfg.ServiceName, service.cfg.ServiceVersion)

	return nil
}

func (service *igeService) Shutdown() {
	if service.started {
		service.started = false
		_ = service.shutdownFunc()
	}
}
